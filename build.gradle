import java.time.LocalDate

/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/7.4/samples
 */

ext{
    javaVersion = 11
    currentDate = LocalDate.now()
}

println ext.javaVersion
println project.ext.javaVersion
println javaVersion
println project.javaVersion
println project."projectParam1"
println "---- All properties: "
println project.properties
println "---- System: "
println System.getProperty("sys.example")

task hello(description: "Hello task", group: "dmdev", type: DefaultTask) {
    println "configuration phase. Task hello"

//    description= "Hello task"
//    group = "klasevich"

    doLast{
        println "execution phase, Action 1"
    }

    doFirst {
        println "execution phase, Action 2"
    }

    doLast{
        println "execution phase, Action 3"
    }
    println "task $description, group: $group, actions: ${actions.size()}"
    println "path task: $path"
  }

task first{
    doLast {
        println "Task 1"
    }
}
task second{
    doLast {
        println "Task 2"
    }
}
task third{
    doLast {
        println "Task 3"
    }
}
task fourth(group: "klass"){
    doLast {
        println "Task 4"
    }
}

//2 <--4

//fourth.dependsOn second
//second.dependsOn first
//second.finalizedBy third
fourth.dependsOn first
fourth.dependsOn second
fourth.dependsOn third

//second.mustRunAfter first
first.mustRunAfter second
//second.shouldRunAfter first

gradle.taskGraph.whenReady { TaskExecutionGraph graph ->
        println " ---- Graph"
    graph.allTasks.each{
        println "${it.name}"
    }
}

gradle.taskGraph.beforeTask {Task task ->
    if(task.group == "klass") {
        println "beforeTask callBack $task"
    }
}

gradle.taskGraph.afterTask {Task task ->
    if(task.name == 'first')
    println "afterTask callBack $task"
}

defaultTasks "fourth"